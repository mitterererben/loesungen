import React, { useState } from 'react';
import { AlertCircle, CheckCircle2, ChevronRight, Hospital, Phone, Mail, MapPin, Calendar, FileText, Users } from 'lucide-react';

export default function LiquorfistelHelper() {
  const [activeTab, setActiveTab] = useState('situation');
  const [checkedItems, setCheckedItems] = useState({});

  const toggleCheck = (id) => {
    setCheckedItems(prev => ({ ...prev, [id]: !prev[id] }));
  };

  const spezialkliniken = [
    {
      name: "Charité Berlin - Klinik für Neurochirurgie",
      leiter: "Prof. Dr. Peter Vajkoczy",
      expertise: "Schädelbasis, rezidivierende Liquorfisteln, über 6.000 OPs/Jahr",
      kontakt: "Tel: +49 30 450 560 002",
      email: "neurochirurgie@charite.de",
      besonderheit: "Führende Expertise bei komplexen, therapieresistenten Fällen",
      prioritaet: "SEHR HOCH"
    },
    {
      name: "Universitätsklinikum Tübingen - Neurochirurgie",
      leiter: "Prof. Dr. Marcos Tatagiba",
      expertise: "Weltweite Expertise Schädelbasischirurgie, Liquorfisteln",
      kontakt: "Tel: +49 7071 29-80442",
      email: "neurochirurgie@med.uni-tuebingen.de",
      besonderheit: "Renommiertes Zentrum für Schädelbasis-Operationen",
      prioritaet: "SEHR HOCH"
    },
    {
      name: "Universitätsklinikum Freiburg - HNO & Neurochirurgie",
      leiter: "Interdisziplinäres Schädelbasiszentrum",
      expertise: "Endoskopische Duraplastiken, Liquorfistelverschluss",
      kontakt: "Tel: +49 761 270-0",
      email: "info@uniklinik-freiburg.de",
      besonderheit: "Top 5 Klinikum Deutschland, interdisziplinäres Team",
      prioritaet: "HOCH"
    },
    {
      name: "Universitätsklinikum Heidelberg - Neurochirurgie",
      leiter: "Schädelbasischirurgie-Team",
      expertise: "Neuroonkologie, Schädelbasischirurgie, komplexe Fälle",
      kontakt: "Tel: +49 6221 56-0",
      email: "info@med.uni-heidelberg.de",
      besonderheit: "Exzellente Forschung und Behandlung",
      prioritaet: "HOCH"
    }
  ];

  const naechsteSchritte = [
    {
      id: 'step1',
      titel: 'Medizinische Unterlagen zusammenstellen',
      details: [
        'Alle CT/MRT-Bilder auf CD brennen lassen',
        'Operationsberichte aller 8 OPs sammeln',
        'Arztbriefe und Befunde chronologisch ordnen',
        'Aktuelle Symptome dokumentieren (wann tritt Flüssigkeit auf, Menge, Begleiterscheinungen)'
      ]
    },
    {
      id: 'step2',
      titel: 'Zweitmeinung bei Spezialklinik einholen',
      details: [
        'Charité Berlin als erste Wahl kontaktieren (Prof. Vajkoczy)',
        'Alternativ: Tübingen (Prof. Tatagiba) - ebenfalls Top-Expertise',
        'Per Telefon/Email Termin für Zweitmeinungssprechstunde anfragen',
        'Unterlagen vorher per Post/Upload schicken'
      ]
    },
    {
      id: 'step3',
      titel: 'Diagnostik klären',
      details: [
        'Fragen: Wurde Beta-2-Transferrin-Test gemacht? (beweist Liquor)',
        'Wurde Fluorescein-Test durchgeführt? (zeigt genaue Leckstelle)',
        'Wurde intrakranieller Druck gemessen?',
        'MR-Myelographie zur Fistel-Lokalisation durchgeführt?'
      ]
    },
    {
      id: 'step4',
      titel: 'Ursachenforschung intensivieren',
      details: [
        'Erhöhter Hirndruck als Ursache? (kann Rezidive verursachen)',
        'Adipositas als Risikofaktor? (bei spontanen Fisteln häufig)',
        'Angeborene Knochendefekte möglich?',
        'Wurde auf alle 3 Fisteltypen untersucht? (ventral, Divertikel, epidurale Venen)'
      ]
    },
    {
      id: 'step5',
      titel: 'Therapieoptionen besprechen',
      details: [
        'Warum schlägt aktuelle OP-Technik nicht an?',
        'Alternative Verschlusstechniken prüfen (Sandwich, Onlay, Underlay)',
        'Lumbaldrainage nach OP zur Druckentlastung?',
        'Gestielter nasoseptaler Lappen als stabilere Abdeckung?'
      ]
    }
  ];

  const wichtigeFragen = [
    "Welche genaue OP-Technik wurde bei den 8 Eingriffen verwendet?",
    "Wurde der intrakranielle Druck gemessen und behandelt?",
    "Gibt es Hinweise auf erhöhten Hirndruck (Kopfschmerzen, Übelkeit)?",
    "Wurde die exakte Lokalisation der Fistel mit Fluorescein bestimmt?",
    "Wie schnell tritt die Flüssigkeit nach den OPs wieder auf?",
    "Gibt es Anzeichen einer Meningitis (Fieber, Nackensteifigkeit)?",
    "Wurde bereits eine Lumbaldrainage postoperativ eingesetzt?"
  ];

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-4 sm:p-6">
      <div className="max-w-6xl mx-auto">
        {/* Header */}
        <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
          <div className="flex items-start gap-4">
            <AlertCircle className="w-8 h-8 text-red-500 flex-shrink-0 mt-1" />
            <div>
              <h1 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">
                Liquorfistel-Lösungswege
              </h1>
              <p className="text-gray-600">
                Rezidivierende Flüssigkeitsansammlung nach 8 OPs - Systematischer Plan für spezialisierte Hilfe
              </p>
            </div>
          </div>
        </div>

        {/* Navigation */}
        <div className="bg-white rounded-xl shadow-lg mb-6 overflow-hidden">
          <div className="flex flex-wrap border-b">
            {[
              { id: 'situation', label: 'Situation', icon: FileText },
              { id: 'kliniken', label: 'Spezialkliniken', icon: Hospital },
              { id: 'schritte', label: 'Nächste Schritte', icon: CheckCircle2 },
              { id: 'fragen', label: 'Wichtige Fragen', icon: Users }
            ].map(tab => (
              <button
                key={tab.id}
                onClick={() => setActiveTab(tab.id)}
                className={`flex-1 min-w-[140px] px-4 py-4 font-medium transition-colors flex items-center justify-center gap-2 ${
                  activeTab === tab.id
                    ? 'bg-indigo-600 text-white'
                    : 'text-gray-600 hover:bg-gray-50'
                }`}
              >
                <tab.icon className="w-4 h-4" />
                <span className="text-sm sm:text-base">{tab.label}</span>
              </button>
            ))}
          </div>
        </div>

        {/* Content */}
        <div className="space-y-6">
          {activeTab === 'situation' && (
            <div className="bg-white rounded-xl shadow-lg p-6">
              <h2 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                <FileText className="w-6 h-6 text-indigo-600" />
                Medizinische Einschätzung
              </h2>
              
              <div className="space-y-4">
                <div className="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                  <h3 className="font-semibold text-yellow-900 mb-2">Diagnose wahrscheinlich:</h3>
                  <p className="text-yellow-800">
                    <strong>Rezidivierende Liquorfistel</strong> (Rhinoliquorrhoe oder spontane intrakranielle Hypotension)
                    - Eine pathologische Verbindung zwischen Liquorraum und Außenwelt, die sich trotz 8 Operationen immer wieder bildet.
                  </p>
                </div>

                <div className="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                  <h3 className="font-semibold text-red-900 mb-2">Kritische Situation:</h3>
                  <ul className="text-red-800 space-y-1 text-sm">
                    <li>• 8 OPs ohne dauerhaften Erfolg → akute Spezialisierung nötig</li>
                    <li>• Erhöhtes Meningitis-Risiko (5-10% bei Liquorfisteln über 7 Tage)</li>
                    <li>• Ursache ungeklärt → falsche OP-Technik oder übersehene Grunderkrankung?</li>
                  </ul>
                </div>

                <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                  <h3 className="font-semibold text-blue-900 mb-2">Mögliche Ursachen bei Rezidiven:</h3>
                  <ul className="text-blue-800 space-y-1 text-sm">
                    <li>• <strong>Erhöhter intrakranieller Druck</strong> (drückt Transplantat raus)</li>
                    <li>• <strong>Falsche Verschlusstechnik</strong> (underlay vs. onlay vs. sandwich)</li>
                    <li>• <strong>Übersehene zweite Fistelstelle</strong></li>
                    <li>• <strong>Angeborene Knochendefekte</strong> oder Dura-Schwachstellen</li>
                    <li>• <strong>Adipositas</strong> (bei spontanen Fisteln Risikofaktor)</li>
                  </ul>
                </div>

                <div className="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                  <h3 className="font-semibold text-green-900 mb-2">Gute Nachrichten:</h3>
                  <ul className="text-green-800 space-y-1 text-sm">
                    <li>• 98% Heilungsrate bei richtiger Behandlung durch Spezialisten</li>
                    <li>• Mikrochirurgischer Verschluss kann >90% Heilung erreichen</li>
                    <li>• Deutschland hat mehrere Weltklasse-Zentren für diesen Fall</li>
                  </ul>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'kliniken' && (
            <div className="space-y-4">
              {spezialkliniken.map((klinik, idx) => (
                <div key={idx} className="bg-white rounded-xl shadow-lg overflow-hidden">
                  <div className={`p-1 ${klinik.prioritaet === 'SEHR HOCH' ? 'bg-red-500' : 'bg-orange-500'}`}>
                    <div className="text-center text-white text-xs font-bold">
                      PRIORITÄT: {klinik.prioritaet}
                    </div>
                  </div>
                  <div className="p-6">
                    <div className="flex items-start justify-between mb-4">
                      <div>
                        <h3 className="text-lg font-bold text-gray-900">{klinik.name}</h3>
                        <p className="text-sm text-indigo-600 font-medium">{klinik.leiter}</p>
                      </div>
                      <Hospital className="w-8 h-8 text-indigo-600 flex-shrink-0" />
                    </div>
                    
                    <div className="space-y-3 text-sm">
                      <div className="flex items-start gap-2">
                        <CheckCircle2 className="w-4 h-4 text-green-500 flex-shrink-0 mt-0.5" />
                        <span className="text-gray-700"><strong>Expertise:</strong> {klinik.expertise}</span>
                      </div>
                      
                      <div className="flex items-start gap-2">
                        <Phone className="w-4 h-4 text-blue-500 flex-shrink-0 mt-0.5" />
                        <span className="text-gray-700">{klinik.kontakt}</span>
                      </div>
                      
                      <div className="flex items-start gap-2">
                        <Mail className="w-4 h-4 text-purple-500 flex-shrink-0 mt-0.5" />
                        <span className="text-gray-700">{klinik.email}</span>
                      </div>
                      
                      <div className="bg-indigo-50 p-3 rounded-lg mt-3">
                        <p className="text-indigo-900 text-xs font-medium">{klinik.besonderheit}</p>
                      </div>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          )}

          {activeTab === 'schritte' && (
            <div className="space-y-4">
              {naechsteSchritte.map((schritt, idx) => (
                <div key={schritt.id} className="bg-white rounded-xl shadow-lg p-6">
                  <div className="flex items-start gap-3 mb-4">
                    <div className="flex-shrink-0 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold">
                      {idx + 1}
                    </div>
                    <div className="flex-1">
                      <div className="flex items-center justify-between mb-3">
                        <h3 className="text-lg font-bold text-gray-900">{schritt.titel}</h3>
                        <button
                          onClick={() => toggleCheck(schritt.id)}
                          className={`p-2 rounded-lg transition-colors ${
                            checkedItems[schritt.id]
                              ? 'bg-green-100 text-green-600'
                              : 'bg-gray-100 text-gray-400 hover:bg-gray-200'
                          }`}
                        >
                          <CheckCircle2 className="w-5 h-5" />
                        </button>
                      </div>
                      <ul className="space-y-2">
                        {schritt.details.map((detail, i) => (
                          <li key={i} className="flex items-start gap-2 text-sm text-gray-700">
                            <ChevronRight className="w-4 h-4 text-indigo-500 flex-shrink-0 mt-0.5" />
                            <span>{detail}</span>
                          </li>
                        ))}
                      </ul>
                    </div>
                  </div>
                </div>
              ))}

              <div className="bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white">
                <h3 className="text-lg font-bold mb-2 flex items-center gap-2">
                  <Calendar className="w-5 h-5" />
                  Zeitplan
                </h3>
                <div className="space-y-2 text-sm">
                  <p><strong>Diese Woche:</strong> Unterlagen zusammenstellen, Charité/Tübingen kontaktieren</p>
                  <p><strong>Nächste 1-2 Wochen:</strong> Zweitmeinungstermin vereinbaren</p>
                  <p><strong>Innerhalb 4 Wochen:</strong> Bei Spezialklinik vorstellen und neue Behandlungsstrategie festlegen</p>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'fragen' && (
            <div className="bg-white rounded-xl shadow-lg p-6">
              <h2 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                <Users className="w-6 h-6 text-indigo-600" />
                Wichtige Fragen für Ärztegespräche
              </h2>
              
              <p className="text-gray-600 mb-6 text-sm">
                Diese Fragen helfen, die bisherige Behandlung zu verstehen und neue Ansätze zu finden:
              </p>
              
              <div className="space-y-3">
                {wichtigeFragen.map((frage, idx) => (
                  <div key={idx} className="flex items-start gap-3 p-4 bg-gray-50 rounded-lg hover:bg-indigo-50 transition-colors">
                    <div className="flex-shrink-0 w-6 h-6 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center text-sm font-bold">
                      {idx + 1}
                    </div>
                    <p className="text-gray-800 text-sm">{frage}</p>
                  </div>
                ))}
              </div>

              <div className="mt-6 bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                <p className="text-blue-900 text-sm">
                  <strong>Tipp:</strong> Diese Fragen ausdrucken und zum Arzttermin mitnehmen. Notizen zu den Antworten helfen bei der Zweitmeinung.
                </p>
              </div>
            </div>
          )}
        </div>

        {/* Footer */}
        <div className="mt-6 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl shadow-lg p-6 text-white">
          <h3 className="text-lg font-bold mb-2">Wichtigste Empfehlung:</h3>
          <p className="text-sm leading-relaxed">
            Nach 8 erfolglosen OPs ist eine <strong>Zweitmeinung bei einem spezialisierten Zentrum DRINGEND erforderlich</strong>. 
            Die Charité Berlin (Prof. Vajkoczy) oder Tübingen (Prof. Tatagiba) sind die ersten Anlaufstellen. 
            Diese Kliniken behandeln täglich solche komplexen Fälle und haben Zugang zu modernsten Diagnoseverfahren und OP-Techniken, 
            die in regionalen Kliniken möglicherweise nicht verfügbar sind.
          </p>
        </div>
      </div>
    </div>
  );
}
